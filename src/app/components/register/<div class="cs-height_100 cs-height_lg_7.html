<div class="cs-height_100 cs-height_lg_70"></div>

  <div class="row">
      <div class="col-xl-6 col-md-8 offset-xl-3 offset-md-2">
        <form [formGroup]="form" (ngSubmit)="submit()" class="cs-form_card cs-style1 cs-box_shadow cs-white_bg">
          <div class="cs-form_card_in">
  
            <h2 class="cs-form_title text-center">Crear cuenta</h2>
  
            <!-- Selector de rol -->
            <div class="d-flex justify-content-center gap-2 mt-3">
              <button  type="button"
                      (click)="setRole('patient')"
                      class="btn btn-accent"
                      [ngClass]="{ 'btn-primary': isPatient(), 'btn-outline-primary': !isPatient() }">
                Soy paciente <i class="fa fa-user"></i>
              </button>
              <button type="button"
                      (click)="setRole('professional')"
                      class="btn btn-outline"
                      [ngClass]="{ 'btn-primary': isProfessional(), 'btn-outline-primary': !isProfessional() }">
                Soy profesional <i class="far fa-user"></i>
              </button>
            </div>
  
            <div class="cs-height_30 cs-height_lg_30"></div>
  
            <!-- Comunes -->
            <div class="cs-form_field_wrap">
              <input type="text" formControlName="username" class="cs-form_field" placeholder="Usuario">
              <small class="text-danger" *ngIf="f['username'].touched && f['username'].invalid">Mínimo 3 caracteres.</small>
            </div>
  
            <div class="cs-height_20 cs-height_lg_20"></div>
            <div class="cs-form_field_wrap">
              <input type="email" formControlName="email" class="cs-form_field" placeholder="Correo">
              <small class="text-danger" *ngIf="f['email'].touched && f['email'].invalid">Correo inválido.</small>
            </div>
  
            <div class="cs-height_20 cs-height_lg_20"></div>
            <div class="cs-form_field_wrap">
              <input type="password" formControlName="password" class="cs-form_field" placeholder="Contraseña">
              <!-- ✅ Usa brackets: f['password'] -->
              <small class="text-danger" *ngIf="f['password'].touched && f['password'].invalid">Mínimo 6 caracteres.</small>
            </div>
  
            <!-- Paciente -->
            <div *ngIf="isPatient()" class="mt-3" formGroupName="patient">
              <h5 class="mb-2">Datos de paciente</h5>
              <div class="cs-form_field_wrap">
                <input type="text" formControlName="fullName" class="cs-form_field" placeholder="Nombre completo">
                <small class="text-danger" *ngIf="form.get('patient.fullName')?.touched && form.get('patient.fullName')?.invalid">
                  Requerido (mín. 3)
                </small>
              </div>
              <div class="cs-height_20 cs-height_lg_20"></div>
              <div class="cs-form_field_wrap">
                <input type="text" formControlName="phone" class="cs-form_field" placeholder="Teléfono (opcional)">
              </div>
            </div>
  
            <!-- Profesional (PRE–REGISTRO PASO 1) -->
            <div *ngIf="isProfessional()" class="mt-3" formGroupName="professional">
              <h5 class="mb-2">Pre-registro de profesional (paso 1)</h5>
  
              <div class="cs-form_field_wrap">
                <input type="text" formControlName="fullName" class="cs-form_field" placeholder="Nombre y Apellido">
                <small class="text-danger" *ngIf="form.get('professional.fullName')?.touched && form.get('professional.fullName')?.invalid">
                  Requerido (mín. 3)
                </small>
              </div>
  
              <div class="cs-height_20 cs-height_lg_20"></div>
              <div class="cs-form_field_wrap">
                <input type="text" formControlName="country" class="cs-form_field" placeholder="País">
                <small class="text-danger" *ngIf="form.get('professional.country')?.touched && form.get('professional.country')?.invalid">
                  Requerido
                </small>
              </div>
  
              <div class="cs-height_20 cs-height_lg_20"></div>
              <div class="cs-form_field_wrap">
                <input type="text" formControlName="phone" class="cs-form_field" placeholder="Teléfono (opcional)">
              </div>
  
              <div class="cs-height_20 cs-height_lg_20"></div>
              <div class="cs-form_field_wrap">
                <input type="text" formControlName="specialtyHint" class="cs-form_field" placeholder="Especialidad (guía inicial)">
              </div>
  
              <div class="mt-2 text-muted" style="font-size:.9rem;">
                Al completar este paso crearemos tu cuenta y abriremos tu <b>onboarding profesional</b>.
              </div>
            </div>
  
            <div class="cs-height_20 cs-height_lg_20"></div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="terms" formControlName="terms">
              <label class="form-check-label" for="terms">Acepto términos y condiciones</label>
              <div class="text-danger" *ngIf="form.get('terms')?.touched && form.get('terms')?.invalid">Requerido.</div>
            </div>
  
            <div class="cs-height_20 cs-height_lg_20"></div>
            <button class="cs-btn cs-style1 cs-btn_lg w-100" type="submit">
              <span *ngIf="isPatient()">Crear cuenta</span>
              <span *ngIf="isProfessional()">Continuar al onboarding</span>
            </button>
  
            <div class="cs-height_30 cs-height_lg_30"></div>
            <div class="cs-form_footer text-center">
              ¿Ya tienes cuenta? <a (click)="global.setRouterActive('login')">Ingresa</a>
            </div>
          </div>
        </form>
        
      </div>
    </div>

  <div class="wrapper" [formGroup]="form">

    <!-- Barra lateral + progreso -->
    <div class="steps-area steps-area-fixed">
      <div class="image-holder">
        <img src="assets/specialist-register/img/side-img.jpg" alt="">
      </div>
      <div class="steps clearfix">
        <ul class="tablist multisteps-form__progress">
          <li class="multisteps-form__progress-btn"
              [class.js-active]="step()===1"
              [class.disabled]="!canGoTo(1)"
              (click)="goTo(1)">
            <span>1</span>
          </li>
          <li class="multisteps-form__progress-btn"
              [class.js-active]="step()===2"
              [class.disabled]="!canGoTo(2)"
              (click)="goTo(2)">
            <span>2</span>
          </li>
          <li class="multisteps-form__progress-btn last"
              [class.js-active]="step()===3"
              [class.disabled]="!canGoTo(3)"
              (click)="goTo(3)">
            <span>3</span>
          </li>
        </ul>
      </div>
    </div>
  
    <form class="multisteps-form__form" id="wizard" (ngSubmit)="submit()">
      <div class="form-area position-relative">
  
        <!-- PASO 1: Información personal -->
        <div *ngIf="step()===1" class="js-active" data-animation="slideHorz" [formGroup]="personal">
          <div class="wizard-forms">
            <div class="inner pb-100 clearfix">
              <div class="form-content pera-content">
                <div class="step-inner-content">
                  <span class="step-no">Paso 1</span>
                  <h2>Información personal</h2>
                  <p>Por favor lea cuidadosamente y complete su información.</p>
  
                  <div class="form-inner-area">
                    <input type="text" class="form-control" placeholder="Nombre completo *" formControlName="full_name">
                    <input type="email" class="form-control" placeholder="Correo *" formControlName="email">
                    <input type="text" class="form-control" placeholder="Teléfono" formControlName="phone">
                    <input type="text" class="form-control" placeholder="Dirección de habitación" formControlName="address">
                    <input type="text" class="form-control" placeholder="Dirección de consultorio" formControlName="consultationAddress">
                    <input type="text" class="form-control" placeholder="Ciudad" formControlName="city">
                    <input type="text" class="form-control" placeholder="País *" formControlName="country">
                  </div>
  
                  <div class="gender-selection">
                    <h3>Género:</h3>
                    <label>
                      <input type="radio" value="Male" formControlName="gender">
                      <span class="checkmark"></span>Masculino
                    </label>
                    <label>
                      <input type="radio" value="Female" formControlName="gender">
                      <span class="checkmark"></span>Femenino
                    </label>
                    <label>
                      <input type="radio" value="Other" formControlName="gender">
                      <span class="checkmark"></span>Otro
                    </label>
                  </div>
  
                  <!-- Uploader documento de identidad -->
                  <div class="upload-documents">
                    <h3>Cargue su documento de identidad:</h3>
                    <!-- Usa tu componente/adapter real; aquí solo ejemplifico el hook -->
                    <!--
                    <ngx-awesome-uploader
                      [adapter]="adapter"
                      [captions]="captions"
                      [showPreviewContainer]="true"
                      (fileUploaded)="onIdDocumentUploaded($event.url)">
                    </ngx-awesome-uploader>
                    -->
                  </div>
  
                  <!-- Uploader foto -->
                  <div class="upload-documents">
                    <h3>Cargue su fotografía personal:</h3>
                    <!--
                    <ngx-awesome-uploader
                      [adapter]="adapterAvatar"
                      [captions]="captionsAvatar"
                      [showPreviewContainer]="true"
                      (fileUploaded)="onAvatarUploaded($event.url)">
                    </ngx-awesome-uploader>
                    -->
                  </div>
                </div>
              </div>
            </div>
  
            <div class="actions">
              <ul>
                <li><span title="NEXT" (click)="next()">Siguiente <i class="fa fa-arrow-right"></i></span></li>
              </ul>
            </div>
          </div>
        </div>
  
        <!-- PASO 2: Información profesional -->
        <div *ngIf="step()===2" class="" data-animation="slideHorz" [formGroup]="professional">
          <div class="wizard-forms">
            <div class="inner pb-100 clearfix">
              <div class="form-content pera-content">
                <div class="step-inner-content">
                  <span class="step-no bottom-line">Paso 2</span>
                  <div class="step-progress float-right">
                    <span>2 de 3 completado</span>
                    <div class="step-progress-bar">
                      <div class="progress">
                        <div class="progress-bar" [style.width.%]="progressPct()"></div>
                      </div>
                    </div>
                  </div>
  
                  <h2>Información profesional</h2>
                  <div class="form-inner-area">
                    <input type="text" class="form-control" placeholder="Profesión *" formControlName="profession">
                    <input type="text" class="form-control" placeholder="Área de estudio *" formControlName="studyArea">
                    <input type="text" class="form-control" placeholder="Universidad de egreso *" formControlName="university">
                    <input type="text" class="form-control" placeholder="Año de egreso * (YYYY)" formControlName="graduationYear">
                  </div>
  
                  <div class="language-select">
                    <p>Seleccione la profesión a la que pertenece:</p>
                    <!-- Con Reactive Forms (si usas ng-multiselect-dropdown) -->
                    <!--
                    <ng-multiselect-dropdown
                      formControlName="category"
                      [data]="categories"
                      [settings]="dropdownSettings"
                      (onSelect)="onCategoryChange($event)"
                      (onDeSelect)="onCategoryChange(null)">
                    </ng-multiselect-dropdown>
                    -->
                    <!-- Alternativa simple sin lib: -->
                    <select class="form-control" formControlName="category" (change)="onCategoryChange($event.target)">
                      <option [ngValue]="null">Seleccione Profesión</option>
                      <option *ngFor="let c of categories" [ngValue]="c.item_id">{{c.item_text}}</option>
                    </select>
                  </div>
  
                  <div class="language-select" *ngIf="(professional.get('category')?.value)">
                    <p>Seleccione la especialidad:</p>
                    <!-- Con ng-multiselect-dropdown (multi) -->
                    <!--
                    <ng-multiselect-dropdown
                      formControlName="specialties"
                      [data]="specialtiesFiltered"
                      [settings]="{ ...dropdownSettings, singleSelection:false }">
                    </ng-multiselect-dropdown>
                    -->
                    <!-- Alternativa simple: -->
                    <select class="form-control" formControlName="specialties" multiple>
                      <option *ngFor="let s of specialtiesFiltered" [ngValue]="s.item_id">{{s.item_text}}</option>
                    </select>
                  </div>
  
                  <div class="upload-documents">
                    <h3>Cargue sus certificados:</h3>
                    <!--
                    <ngx-awesome-uploader
                      [adapter]="adapterCertificates"
                      [captions]="captionsCertificates"
                      [showPreviewContainer]="true"
                      (fileUploaded)="onCertificateUploaded($event.url)">
                    </ngx-awesome-uploader>
                    -->
                  </div>
                </div>
              </div>
            </div>
  
            <div class="actions">
              <ul>
                <li><span class="js-btn-prev" title="BACK" (click)="prev()"><i class="fa fa-arrow-left"></i> Ant.</span></li>
                <li><span title="NEXT" (click)="next()">Sig. <i class="fa fa-arrow-right"></i></span></li>
              </ul>
            </div>
          </div>
        </div>
  
        <!-- PASO 3: Información laboral -->
        <div *ngIf="step()===3" class="" data-animation="slideHorz" [formGroup]="laboral">
          <div class="wizard-forms">
            <div class="inner pb-100 clearfix">
              <div class="form-content pera-content">
                <div class="step-inner-content">
                  <span class="step-no bottom-line">Paso 3</span>
                  <div class="step-progress float-right">
                    <span>3 de 3 completado</span>
                    <div class="step-progress-bar">
                      <div class="progress">
                        <div class="progress-bar" [style.width.%]="progressPct()"></div>
                      </div>
                    </div>
                  </div>
  
                  <h2>Información laboral</h2>
                  <p>Ingrese la información necesaria para la atención de sus clientes.</p>
  
                  <div class="step-content-area">
                    <div class="budget-area">
                      <div class="opti-list">
                        <div>
                          <p>¿Qué días atenderá?</p>
  
                          <ul class="d-flex" formArrayName="days">
                            <li *ngFor="let d of daysFA.controls; let i = index">
                              <label style="cursor:pointer;">
                                <input type="checkbox" [formControlName]="i">
                                {{ ['LU','MA','MI','JU','VI','SA','DO'][i] }}
                              </label>
                            </li>
                          </ul>
  
                          <small class="text-danger" *ngIf="!anyDaySelected && laboral.touched">
                            Selecciona al menos un día.
                          </small>
                          
                        </div>
                      </div>
                    </div>
                  </div>
  
                </div>
              </div>
            </div>
  
            <div class="actions">
              <ul>
                <li><span class="js-btn-prev" title="BACK" (click)="prev()"><i class="fa fa-arrow-left"></i> Ant.</span></li>
                <li><button type="submit" title="NEXT">Finalizar <i class="fa fa-arrow-right"></i></button></li>
              </ul>
            </div>
          </div>
        </div>
  
        <!-- ÉXITO -->
        <div *ngIf="isSuccess()" class="" data-animation="slideHorz">
          <div class="wizard-forms">
            <div class="inner pb-100 clearfix">
              <div class="form-content pera-content">
                <div class="step-inner-content">
                  <span class="step-no bottom-line">✔</span>
                  <h2>¡Felicidades!</h2>
                  <p>Hemos recibido su información. Revisaremos y activaremos su cuenta en breve.</p>
                </div>
              </div>
            </div>
            <div class="actions">
              <ul>
                <li><a class="btn btn-primary" routerLink="/dashboard">Ir al panel</a></li>
              </ul>
            </div>
          </div>
        </div>
  
      </div>
    </form>
  </div>
  
  <!-- Tu navbar permanece igual -->
  <nav class="custom-navbar navbar navbar-expand-lg navbar-fixed navbar-transfarent">
    <div class="container">
      <a class="navbar-brand m-0">
        <img class="logo-white" src="assets/camiwa/images/logo-white.png" alt="">
        <img class="logo-dark" src="assets/camiwa/images/logo.png" alt="">
      </a>
      <div class="d-flex order-lg-2">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent">
          <span id="nav-icon"><span></span><span></span><span></span></span>
        </button>
      </div>
      <div class="collapse navbar-collapse" id="navbarSupportedContent"></div>
    </div>
  </nav>
  
  <div class="cs-height_90 cs-height_lg_80"></div>

  